<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>時間割</title>
    <!-- <link rel="stylesheet" type="text/css" href="jikanwari.css"> -->
    <link rel="stylesheet" type="text/css" href="css/reset.css" />
    <link rel="stylesheet" type="text/css" href="css/sanitize.css" />
    <link rel="stylesheet" type="text/css" href="css/style.css" />
</head>

<body>
    <table align="center">
        <thead>
            <tr>
                <th width="10%"> </th>
                <th width="18%">月</th>
                <th width="18%">火</th>
                <th width="18%">水</th>
                <th width="18%">木</th>
                <th width="18%">金</th>
            </tr>
        </thead>

        <tbody>
            <tr>
                <th align="center">1</th>
                <td id="a1" onclick="clicked('a1')"></td>
                <td id="b1" onclick="clicked('b1')"></td>
                <td id="c1" onclick="clicked('c1')"></td>
                <td id="d1" onclick="clicked('d1')"></td>
                <td id="e1" onclick="clicked('e1')"></td>
            </tr>
            <tr>
                <th class="center">2</th>
                <td id="a1" onclick="clicked('a2')"></td>
                <td id="b1" onclick="clicked('b2')"></td>
                <td id="c1" onclick="clicked('c2')"></td>
                <td id="d1" onclick="clicked('d2')"></td>
                <td id="e1" onclick="clicked('e2')"></td>
            </tr>
            <tr>
                <th class="center">3</th>
                <td id="a1" onclick="clicked('a3')"></td>
                <td id="b1" onclick="clicked('b3')"></td>
                <td id="c1" onclick="clicked('c3')"></td>
                <td id="d1" onclick="clicked('d3')"></td>
                <td id="e1" onclick="clicked('e3')"></td>
            </tr>
            <tr>
                <th class="center">4</th>
                <td id="a1" onclick="clicked('a4')"></td>
                <td id="b1" onclick="clicked('b4')"></td>
                <td id="c1" onclick="clicked('c4')"></td>
                <td id="d1" onclick="clicked('d4')"></td>
                <td id="e1" onclick="clicked('e4')"></td>
            </tr>
            <tr>
                <th class="center">5</th>
                <td id="a1" onclick="clicked('a5')"></td>
                <td id="b1" onclick="clicked('b5')"></td>
                <td id="c1" onclick="clicked('c5')"></td>
                <td id="d1" onclick="clicked('d5')"></td>
                <td id="e1" onclick="clicked('e5')"></td>
            </tr>
            <tr>
                <th class="center">6</th>
                <td id="a1" onclick="clicked('a6')"></td>
                <td id="b1" onclick="clicked('b6')"></td>
                <td id="c1" onclick="clicked('c6')"></td>
                <td id="d1" onclick="clicked('d6')"></td>
                <td id="e1" onclick="clicked('e6')"></td>
            </tr>
            <tr>
                <th class="center">7</th>
                <td id="a1" onclick="clicked('a7')"></td>
                <td id="b1" onclick="clicked('b7')"></td>
                <td id="c1" onclick="clicked('c7')"></td>
                <td id="d1" onclick="clicked('d7')"></td>
                <td id="e1" onclick="clicked('e7')"></td>
            </tr>
        </tbody>
    </table>
    <div>
        <input id="subject">
    </div>
    <div>
        <button id="finish" onclick="finish()">完成</button>
        <button id="restore" onclick="shutoku();restoreTable(data)">ロード</button>
    </div>

    <!-- ここからJavascript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <script>
        // // 完成クリックイベント
        // $('#kansei').on('click', function () {
        //     var text = $("#").val();
        //     localStorage.setItem('memo', text);
        //     var data = {
        //         text: $(id).val()
        //     }

        // });
        let data = {}
        let dayOfweek
        window.onload = function () {
            date = new Date()
            dayOfweek = date.getDay()
        }

        function shutoku() {
            let lokal = localStorage.getItem("table_data")
            data = JSON.parse(lokal)
            console.log(lokal)
        }
        function clicked(id) {
            let cell = document.getElementById(id)
            let inputcell = document.getElementById("subject")
            console.log(inputcell.value)
            data[id] = inputcell.value
            cell.innerHTML = inputcell.value
            let table = data[id]
            localStorage.setItem("table_data", JSON.stringify(data))
            console.log(data)
        }

        function finished() {
            let inputcell = document.getElementById("subject")
            inputcell.style.visibility = "hidden"
        }


        function restoreTable(data) {
            for (let k in data) {
                let cell = document.getElementById(k)
                let col = k[0]
                let colLeft = { "a": "e", "b": "a", "c": "b", "d": "c", "e": "d" }[col]
                cell.innerHTML = data[k]
                for (var i = 1; i < 8; i++) {
                    var cellLeft = colLeft + String(i)
                    if (data[celLeft] == data[k]) {
                        cell.innerHTML = "○" + data[k]//これが前の日と同じ
                    }
                }
                console.log(col, colLeft, cellLeft)
            }
        }
    </script>
</body>

</html>